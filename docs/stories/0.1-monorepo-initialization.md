# Story 0.1: Monorepo Initialization

## Status
Draft

## Parent Epic
[Epic 0: Technical Foundation](../epic-0-technical-foundation.md)

## Story
**As a** developer,
**I want** a properly configured npm workspaces monorepo,
**So that** I can work on any package with consistent tooling

## Acceptance Criteria
1. npm workspaces initialized in root package.json
2. Root `package.json` with workspace scripts
3. `.nvmrc` or `.node-version` specifying Node.js 20 LTS
4. Workspaces defined in package.json

## Tasks / Subtasks
- [ ] Initialize npm workspaces in package.json (AC: 1, 4)
  - [ ] Create root package.json with workspaces configuration
  - [ ] Define workspace paths: `apps/*`, `packages/*`
- [ ] Create directory structure (AC: 1)
  - [ ] Create `apps/web/` directory for React frontend
  - [ ] Create `apps/api/` directory for Express backend
  - [ ] Create `packages/shared/` directory for shared code
  - [ ] Create `packages/roadmap-engine/` directory for DAG logic
  - [ ] Create `podman/` directory for container configs
  - [ ] Create `scripts/` directory for utility scripts
  - [ ] Create `docs/` directory for documentation
- [ ] Set up root scripts (AC: 2)
  - [ ] Add `dev` script to run all workspaces
  - [ ] Add `build` script to build all packages
  - [ ] Add `test` script to run all tests
  - [ ] Add `lint` script for linting
  - [ ] Add `typecheck` script for TypeScript validation
- [ ] Configure workspace dependencies (AC: 4)
  - [ ] Set up proper workspace references
- [ ] Create `.nvmrc` file with Node.js 20 LTS (AC: 3)

## Dev Notes

### Directory Structure
```
plpg/
├── apps/
│   ├── web/                    # React frontend (Vite)
│   └── api/                    # Express backend
├── packages/
│   ├── shared/                 # Shared types, utils, validation
│   │   ├── src/
│   │   │   ├── types/          # TypeScript interfaces
│   │   │   ├── constants/      # Shared constants
│   │   │   ├── utils/          # Utility functions
│   │   │   └── validation/     # Zod schemas
│   │   ├── prisma/             # Database schema & migrations
│   │   └── package.json
│   └── roadmap-engine/         # DAG logic (future E3)
├── podman/
│   ├── podman-compose.yml      # All services
│   └── podman-compose.dev.yml  # Development overrides
├── scripts/
│   ├── setup.sh                # Initial setup script
│   └── seed.ts                 # Database seeding
├── docs/
├── .github/
│   └── workflows/
├── package.json
└── README.md
```

### Root package.json Structure
```json
{
  "name": "plpg",
  "private": true,
  "workspaces": [
    "apps/*",
    "packages/*"
  ],
  "scripts": {
    "dev": "npm run dev --workspaces --if-present",
    "build": "npm run build --workspaces --if-present",
    "test": "npm run test --workspaces --if-present",
    "lint": "npm run lint --workspaces --if-present",
    "typecheck": "npm run typecheck --workspaces --if-present"
  }
}
```

### Testing
- **Test file location**: N/A for this story (infrastructure setup)
- **Test standards**: Verify workspaces resolve correctly using `npm ls`
- **Verification**: Run `npm install` from root and verify all workspaces are linked

## Definition of Done
- [ ] npm workspaces initialized and functional
- [ ] All directory structure created as specified
- [ ] Root scripts (`dev`, `build`, `test`, `lint`, `typecheck`) defined
- [ ] `.nvmrc` file present with Node.js 20 LTS version
- [ ] `npm install` runs successfully from root
- [ ] Workspace dependencies resolve correctly

## Unit Test Cases
- Verify `npm ls` shows all workspaces linked correctly
- Verify `npm run` scripts are accessible from root
- Verify Node.js version matches `.nvmrc` specification

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-01-08 | 0.1 | Initial story creation | SM Agent |
